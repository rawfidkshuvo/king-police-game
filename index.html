<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplayer Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        .button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<div class="game-container">
    <h1>Welcome to the Multiplayer Game</h1>
    <div id="status"></div>
    <input type="text" id="username" placeholder="Enter your username" />
    <input type="text" id="room_code" placeholder="Enter Room Code" />
    <button class="button" id="join_button">Join Room</button>
    <button class="button" id="start_button" disabled>Start Game</button>
    <div id="players_list"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.min.js"></script>
<script>
    const socket = io(); // Connect to the Socket.IO server

    const joinButton = document.getElementById("join_button");
    const startButton = document.getElementById("start_button");
    const usernameInput = document.getElementById("username");
    const roomCodeInput = document.getElementById("room_code");
    const playersList = document.getElementById("players_list");
    const statusDiv = document.getElementById("status");

    let roomCode = "";
    let username = "";

    // Emit event to join the room
    joinButton.addEventListener("click", () => {
        username = usernameInput.value.trim();
        roomCode = roomCodeInput.value.trim();

        if (username && roomCode) {
            socket.emit("join_room", { username, room_code: roomCode });
        } else {
            alert("Please enter a username and room code.");
        }
    });

    // Emit event to start the game
    startButton.addEventListener("click", () => {
        socket.emit("start_game", { room_code: roomCode });
    });

    // Listen for player joining
    socket.on("player_joined", (data) => {
        console.log(data);
        const { players } = data;
        playersList.innerHTML = "Players in the room: " + players.join(", ");
        statusDiv.innerHTML = "Waiting for other players...";
        if (players.length === 4) {
            startButton.disabled = false;
            statusDiv.innerHTML = "All players joined. Ready to start!";
        }
    });

    // Listen for start game
    socket.on("new_turn", (data) => {
        console.log("New turn started: ", data);
        // Handle the turn and display the roles
        alert("New turn started! Roles are assigned.");
    });

    // Listen for errors (e.g., not enough players)
    socket.on("error", (data) => {
        alert(data.message);
    });
</script>

</body>
</html>
