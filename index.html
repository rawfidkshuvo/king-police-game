<!DOCTYPE html>
<html>
<head>
    <title>King-Police-Robber-Thief Game</title>
    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
</head>
<body>
    <h1>King-Police-Robber-Thief</h1>
    <div id="menu">
        <input type="text" id="roomCode" placeholder="Room Code" />
        <input type="text" id="username" placeholder="Username" />
        <button id="createRoom">Create Room</button>
        <button id="joinRoom">Join Room</button>
    </div>
    <div id="game" style="display: none;">
        <h2>Players</h2>
        <ul id="players"></ul>
        <h2>Scores</h2>
        <ul id="scores"></ul>
        <h2>Roles</h2>
        <ul id="roles"></ul>
        <button id="guessButton" style="display: none;">Make Guess</button>
    </div>
    <script>
        const socket = io("https://king-police-backend.onrender.com");

        document.getElementById("createRoom").onclick = () => {
            const roomCode = document.getElementById("roomCode").value;
            socket.emit("create_room", { room_code: roomCode });
        };

        document.getElementById("joinRoom").onclick = () => {
            const roomCode = document.getElementById("roomCode").value;
            const username = document.getElementById("username").value;
            socket.emit("join_room", { room_code: roomCode, username: username });
        };

        socket.on("room_created", (data) => {
            alert(`Room ${data.room_code} created! Share with friends.`);
        });

        socket.on("player_joined", (data) => {
            const playerList = document.getElementById("players");
            playerList.innerHTML = "";
            data.players.forEach((player) => {
                const li = document.createElement("li");
                li.textContent = player;
                playerList.appendChild(li);
            });
            document.getElementById("menu").style.display = "none";
            document.getElementById("game").style.display = "block";
        });

        socket.on("new_turn", (data) => {
            const roles = data.roles;
            const roleList = document.getElementById("roles");
            roleList.innerHTML = "";
            Object.entries(roles).forEach(([player, role]) => {
                const li = document.createElement("li");
                li.textContent = `${player}: ${role}`;
                roleList.appendChild(li);
            });
        });

        socket.on("update_scores", (data) => {
            const scores = data.scores;
            const scoreList = document.getElementById("scores");
            scoreList.innerHTML = "";
            Object.entries(scores).forEach(([player, score]) => {
                const li = document.createElement("li");
                li.textContent = `${player}: ${score}`;
                scoreList.appendChild(li);
            });
        });

        socket.on("game_over", (data) => {
            alert(`Game Over! Winner: ${data.winner}`);
            document.getElementById("game").style.display = "none";
            document.getElementById("menu").style.display = "block";
        });
    </script>
</body>
</html>
